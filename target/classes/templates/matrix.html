<!DOCTYPE html>
<html th:replace="~{fragments/layout :: layout('–ú–∞—Ç—Ä–∏—Ü–∞ –æ—Ü–µ–Ω–∞', ~{::.main-container})}" xmlns:th="http://www.thymeleaf.org">
<head/>
<body>
<div class="main-container">

    <h2>üìÖ –ú–∞—Ç—Ä–∏—Ü–∞ –æ—Ü–µ–Ω–∞ ‚Äî <span th:text="${child.name}"></span>, <span th:text="${year}"></span>. –≥–æ–¥–∏–Ω–∞</h2>

    <!-- üìù –§–æ—Ä–º–∞ –∑–∞ —É–Ω–æ—Å –æ—Ü–µ–Ω–µ -->
    <form th:action="@{/matrix/update}" method="post" style="margin-bottom:2rem;">
        <input type="hidden" name="childId" th:value="${child.id}" />
        <input type="hidden" name="year" th:value="${year}" />

        <label>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç:</label>
        <select name="activityId" required>
            <option th:each="row : ${matrix}"
                    th:value="${row.activity.id}"
                    th:text="${row.activity.name}">
            </option>
        </select>

        <label>–ù–µ–¥–µ—ô–∞:</label>
        <input type="number" name="weekIndex" min="0" max="51" required />

        <label>–û—Ü–µ–Ω–∞:</label>
        <input type="number" name="score" min="0" required />

        <button type="submit">‚úÖ –£–Ω–µ—Å–∏</button>
    </form>

    <!-- üîí –§–æ—Ä–º–∞ –∑–∞ –∑–∞–∫—ô—É—á–∞–≤–∞—ö–µ –Ω–µ–¥–µ—ô–µ -->
    <form th:action="@{/matrix/lock}" method="post" style="margin-bottom:2rem;">
        <input type="hidden" name="childId" th:value="${child.id}" />
        <input type="hidden" name="year" th:value="${year}" />

        <label>–ó–∞–∫—ô—É—á–∞—ò –Ω–µ–¥–µ—ô—É:</label>
        <input type="number" name="weekIndex" min="0" max="51" required />
        <button type="submit">üîí –ó–∞–∫—ô—É—á–∞—ò</button>
    </form>

    <!-- üìä –¢–∞–±–µ–ª–∞ –æ—Ü–µ–Ω–∞ -->
    <div style="overflow:auto; max-height:30rem; border:2px solid #aaa;">
        <table style="
            border-collapse:collapse;
            background:#e6ffe6;
            font-size:0.8rem;
            text-align:center;
            width:max-content;
            min-width:100%;">
            <thead>
            <tr style="background:#cceccc;">
                <th style="border:1px solid #aaa; min-width:12rem; position:sticky; left:0; background:#cceccc; z-index:2;">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç</th>
                <th style="border:1px solid #aaa; min-width:16rem; position:sticky; left:12rem; background:#cceccc; z-index:2;">–û–ø–∏—Å</th>
                <th style="border:1px solid #aaa; min-width:6rem; position:sticky; left:28rem; background:#cceccc; z-index:2;">–ú–∞–∫—Å.</th>
                <th th:each="weekNum : ${#numbers.sequence(1,52)}"
                    th:text="'–ù' + weekNum"
                    style="border:1px solid #aaa; min-width:6rem;">
                </th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="row : ${matrix}">
                <td style="border:1px solid #aaa; text-align:left; min-width:12rem; position:sticky; left:0; background:#f8fff8;" th:text="${row.activity.name}"></td>
                <td style="border:1px solid #aaa; text-align:left; min-width:16rem; position:sticky; left:12rem; background:#f8fff8;" th:text="${row.activity.description}"></td>
                <td style="border:1px solid #aaa; min-width:6rem; position:sticky; left:28rem; background:#f8fff8;" th:text="${row.activity.maxScore}"></td>
                <td th:each="score : ${row.weeklyScores}"
                    style="border:1px solid #aaa; min-width:6rem;"
                    th:text="${score}">
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</div>
</body>
</html>